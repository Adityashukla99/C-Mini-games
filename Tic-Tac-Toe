#include <iostream>
using namespace std;

// Game board
char board[3][3] = {
    {'1','2','3'},
    {'4','5','6'},
    {'7','8','9'}
};

// Player markers and turn tracker
char currentMarker;
int currentPlayer;
char marker_p1, marker_p2;


// Draw the Tic Tac Toe board
void drawBoard() {
    system("cls");
    cout << "\n=============================\n";
    cout << "        TIC TAC TOE\n";
    cout << "=============================\n\n";
    cout << "Player 1 = " << marker_p1 << " | Player 2 = " << marker_p2 << "\n\n";

    cout << " " << board[0][0] << " | " << board[0][1] << " | " << board[0][2] << "\n";
    cout << "---|---|---\n";
    cout << " " << board[1][0] << " | " << board[1][1] << " | " << board[1][2] << "\n";
    cout << "---|---|---\n";
    cout << " " << board[2][0] << " | " << board[2][1] << " | " << board[2][2] << "\n\n";
}

// Place marker in a slot
bool placeMarker(int slot) {
    int row = (slot - 1) / 3;
    int col = (slot - 1) % 3;

    if (board[row][col] != 'X' && board[row][col] != 'O') {
        board[row][col] = currentMarker;
        return true;
    }
    return false;
}

// Check if any player has won
int checkWinner() {
    // Check rows
    for (int i = 0; i < 3; i++) {
        if (board[i][0] == board[i][1] && board[i][1] == board[i][2])
            return (board[i][0] == marker_p1) ? 1 : 2;
    }

    // Check columns
    for (int i = 0; i < 3; i++) {
        if (board[0][i] == board[1][i] && board[1][i] == board[2][i])
            return (board[0][i] == marker_p1) ? 1 : 2;
    }

    // Check diagonals
    if (board[0][0] == board[1][1] && board[1][1] == board[2][2])
        return (board[0][0] == marker_p1) ? 1 : 2;
    if (board[0][2] == board[1][1] && board[1][1] == board[2][0])
        return (board[0][2] == marker_p1) ? 1 : 2;

    return 0; // No winner yet
}

// Swap turn between players
void swapPlayerAndMarker() {
    currentPlayer = (currentPlayer == 1) ? 2 : 1;
    currentMarker = (currentMarker == marker_p1) ? marker_p2 : marker_p1;
}

// Reset the board for a new game
void resetBoard() {
    char start = '1';
    for (int i = 0; i < 3; i++)
        for (int j = 0; j < 3; j++)
            board[i][j] = start++;
}

// Main function
int main() {
    cout << "=============================\n";
    cout << "        TIC TAC TOE GAME\n";
    cout << "=============================\n\n";

    cout << "Player 1, choose your marker (X or O): ";
    cin >> marker_p1;

    if (marker_p1 == 'x') marker_p1 = 'X';
    if (marker_p1 == 'o') marker_p1 = 'O';

    marker_p2 = (marker_p1 == 'X') ? 'O' : 'X';
    currentPlayer = 1;
    currentMarker = marker_p1;

    bool playAgain = true;
    while (playAgain) {
        resetBoard();
        drawBoard();

        int playerWon = 0;
        for (int i = 0; i < 9; i++) {
            int slot;
            cout << "Player " << currentPlayer << " (" << currentMarker << "), enter your slot (1-9): ";
            cin >> slot;


            if (slot < 1 || slot > 9) {
                cout << "Invalid slot! Try again.\n";
                i--;
                continue;
            }

            if (!placeMarker(slot)) {
                cout << "Slot already taken! Try again.\n";
                i--;
                continue;
            }

            drawBoard();

            playerWon = checkWinner();
            if (playerWon == 1) {
                cout << " Player 1 (" << marker_p1 << ") wins!\n";
                break;
            } else if (playerWon == 2) {
                cout << " Player 2 (" << marker_p2 << ") wins!\n";
                break;
            }

            swapPlayerAndMarker();
        }

        if (playerWon == 0)
            cout << " It's a draw!\n";

        char choice;
        cout << "\nDo you want to play again? (Y/N): ";
        cin >> choice;
        if (choice == 'y' || choice == 'Y') {
            currentPlayer = 1;
            currentMarker = marker_p1;
            continue;
        } else {
            playAgain = false;
        }
    }

    cout << "\nThanks for playing Tic Tac Toe!\n";
    return 0;
}
